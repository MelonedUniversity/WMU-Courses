# Y Combinator

$Y$ 组合子

## 概要

$Y$ 组合子又称不动点组合子或不动点算子，是一种高阶函数，由Haskell Brooks Curry发现。由于λ表达式是匿名的，即任何λ表达式均不具有名字，所以是没有办法实现递归的。$Y$ 组合子也是一种λ表达式，它就是来解决该问题的。

## 问题引入

考虑阶乘函数（一般数学表述）：  
$fac(x)=if\ x > 0\ then\ x*fac(x-1)\ else\ 1$  
λ表述：  
$fac=λx.(if\ x > 0\ then\ x*fac(x-1)\ else\ 1)$

你应该注意到，在λ项中递归地使用名 $fac$ 是不恰当的，因为这样的写法并不能归约到不具备名 $fac$ 的函数 $fac$，因而违反了λ项的匿名性，所以我们尝试如下改造该表达式：

$fac'=λx.λf.(if\ x > 0\ then\ x*f(x-1)\ else\ 1)$

我们通过传入函数 $f$ 的方式来表示函数本身，于是我们的阶乘函数定义如下：

$fac=fac'\ fac$

然后我们就可以这样调用：

$\quad fac\ 2$  
$=(fac'\ fac)\ 2$  
$=λx.(if\ x > 0\ then\ x*fac(x-1)\ else\ 1)\ 2$  
$=2*(fac\ 1)$  
$=2*((fac'\ fac)\ 1)$  
$=2*(λx.(if\ x > 0\ then\ x*fac(x-1)\ else\ 1)\ 1)$  
$=2*(if\ 1 > 0\ then\ 1*fac(1-1)\ else\ 1)$  
$=2*(fac\ 0)$  
$=2*((fac'\ fac)\ 0)$  
$=2*(λx.(if\ x > 0\ then\ x*fac(x-1)\ else\ 1)\ 0)$  
$=2*(if\ 0 > 0\ then\ 0*fac(0-1)\ else\ 1)$  
$=2*1=2$

显然，2的阶乘是2。

但λ项中仍然使用了 $fac$，于是我们假设一个高阶函数 $Y=λf.f(Y f)$，则有：  
$Y\ g=g(Y\ g)$  
易得：  
$fac=Y\ fac'=fac'(Y\ fac')⇔fac'\ fac$  

如果该高阶函数 $Y$ 的λ项中不含 $Y$，那么我们就能实现该阶乘函数了。  

## $Y$ 组合子

$Y=λf.((λx.f(x\ x))\ (λx.f(x\ x)))$

考虑归约：  
$\quad Y\ g$  
$=(λx.g(x\ x))\ (λx.g(x\ x))$  
$=g((λx.g(x\ x))\ (λx.g(x\ x))))$  
$=g(Y\ g)$  
可知：$Y⇒Y=λf.f(Y f)$

显然，问题得到了解决，我们阶乘函数的λ表述为：

$fac=(λf.((λx.f(x\ x))\ (λx.f(x\ x))))\ (λx.λf.(if\ x > 0\ then\ x*f(x-1)\ else\ 1))$

可简记为 $fac=Y\ (λx.λf.(if\ x > 0\ then\ x*f(x-1)\ else\ 1))$，这并不影响函数的匿名性。
